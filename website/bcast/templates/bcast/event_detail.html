{% load vardump comments thumbnail sekizai_tags phileo_tags in_group %}
<div class="plugin bcast event detail">

<div class="expandable main window" id="bcast_lead">

	<div class="panel lead">


		<div class="action">
			<h4 class="date">{{ event.date_start|date:"D, d. m. y" }} - {{ event.date_start|date:"H:i" }} / {{ event.type }}</h4>
		</div>
		
		<div class="display">
			<h3><span class="title">{{ event.title }}</span></a></h3>
		</div>
	

	
	
	
	{% if event.excerpt %}
	<div class="padded info" >
		
		<div class="left excerpt">
			<p>
				{{ event.excerpt }}
			</p>
		</div>
		<div class="clear"></div>
	</div>
	{% endif %}
	
	{% if request.user.is_authenticated %}
	
	<div class="padded like">
		
		
		{% addtoblock "js" %}
		
		<script type="text/javascript">
		
		{% likes_ajax %}
		</script>
		
		{% endaddtoblock %}
		
		<!--
		{% like_form request.user event "Like,Unlike" %}
		-->
		
		
	</div>
	{% endif %}
	
	
	<!-- some information for admin -->
	{% if request.user.is_authenticated %}
	
	{% if request.user|in_group:"Streamers" %}

	<div class="admin padded  notice">
		<h5>Stream setup:</h5>
		<ul>
			<li>
				<span>FMS URL:</span><span>rtmp://rtmp.dock18.ch/d18live</span>
			</li>
			<li>
				<span>Stream:</span><span>{{ event.key }}</span>
			</li>
			<li>
				<span>starts_in:</span><span>{{ event.starts_in }}</span> | <span>ends_in:</span><span>{{ event.ends_in }}</span>
			</li>
			<li></li>
			<li>
				<span>date_start:</span><span>{{ event.date_start }}</span> | <span>date_end:</span><span>{{ event.date_end }}</span>
			</li>
			<li>&nbsp;</li>
		</ul>
	</div>
	
	{% endif %}
	
	{% endif %}
	
	</div>
	</div>

	{% addtoblock "js" %}
	<script type="text/javascript">
	
		function countdown_done() {
			location.reload();
		}
		function countdown_tick() {
			$('#chat_f').html( $('#counter').html() );
		}
		
		function countdown_reset(seconds) {
			$('#counter').countdown({
			until: +seconds,
			onExpiry: countdown_done,
			compact: true,
			onTick: countdown_tick
			});
		}
	
	
	</script>
	{% endaddtoblock %}
	
	<div id="counter" style="display: none;"></div>
	
	<!-- loads the counter to be cloned into player window -->
	{% if event.starts_in > 0 %}
	
	
	
	{% addtoblock "js" %}
	<script type="text/javascript">

		$(function() {
			countdown_reset({{ event.starts_in }});
			/*
			$('#counter').countdown({
			until: +{{ event.starts_in }},
			onExpiry: countdown_done,
			compact: true,
			onTick: countdown_tick
			});
			*/
		});


	</script>
	{% endaddtoblock %}

	{% endif %}
	
	

	{% if event.transmission %}
	{% include 'bcast/event/transmission.html' %}
	{% endif %}

	{% if event.chat and event.room %}
	{% include 'bcast/event/chat.html' %}
	{% endif %}
	

	{% if event.chat and event.room %}
	<!--
	{% include 'bcast/event/participants.html' %}
	-->
	{% endif %}

	{% if event.folder %}
	{% include 'bcast/event/filebrowser.html' %}
	{% endif %}
	
</div>